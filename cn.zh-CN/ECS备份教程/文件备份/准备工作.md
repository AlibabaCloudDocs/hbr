# 准备工作 {#concept_qnt_cz5_fgb .concept}

您可以使用混合云备份服务（HBR）来备份ECS实例中的文件，并在文件丢失或受损时及时恢复文件。备份前您需要做以下准备工作。

**说明：** 

-   使用混合云备份客户端时，为达到最佳备份速度，建议运行备份客户端的机器的系统配置使用双核及以上64位CPU，并配备8GB以上可用内存。
-   系统能够备份的数据规模取决于内存资源，在4GB可用系统内存的情况下可备份的最大文件数量及总数据量分别为100万个、8TB。
-   目前HBR仅支持华东1（杭州）、华东2（上海）、华北2（北京）、华南1（深圳）地域下的ECS文件备份。

## 授权角色 {#section_pts_5z5_fgb .section}

使用混合云备份服务来备份ECS文件时需要您同意授权创建两个角色：AliyunHBRDefaultRole，AliyunECSAccessingHBRRole。

## 云助手 {#section_qb5_wz5_fgb .section}

-   ECS备份客户端需要和阿里云云助手配合使用。2017年12月01日之后创建的ECS实例，默认预装了云助手客户端。如果需要备份的ECS实例是2017年12月01日之前购买的，需要您自行[安装云助手客户端](../../../../../intl.zh-CN/用户指南/云助手/云助手客户端.md)。
-   已经安装好云助手的经典网络ECS实例需要按照以下步骤配置云助手。
    -   Windows系统：
        1.  远程连接该ECS实例，在C:\\ProgramData\\aliyun\\assist\\目录下创建`region-id`文件。
        2.  根据ECS所在地域，在文件中填写相应的`region id`。

            |地域|ID|
            |:-|:-|
            |华东1（杭州）|cn-hangzhou|
            |华东2（上海）|cn-shanghai|
            |华北2（北京）|cn-beijing|
            |华南1（深圳）|cn-shenzhen|

        3.  在任务管理器重启AliyunService服务。
    -   Linux系统：
        1.  远程连接该ECS实例，在/usr/local/share/aliyun-assist/目录下创建`region-id`文件。
        2.  根据ECS所在地域，在文件中填写相应的`region id`。

            |地域|ID|
            |:-|:-|
            |华东1（杭州）|cn-hangzhou|
            |华东2（上海）|cn-shanghai|
            |华北2（北京）|cn-beijing|
            |华南1（深圳）|cn-shenzhen|

        3.  重启云助手服务systemctl restart aliyun。

## 安装ECS备份客户端 {#section_vb1_zz5_fgb .section}

ECS备份客户端可以帮助您备份和恢复ECS文件。

**少量安装ECS备份客户端**

如果您需要为少量ECS实例安装ECS备份客户端，根据以下步骤进行操作：

1.  登录[混合云备份管理控制台](https://hbr.console.aliyun.com)。
2.  选择要备份的ECS实例所在的区域。
3.  在左侧导航栏，选择**ECS备份** \> **文件备份**。
4.  在页面右上角，单击**添加ECS实例**。
5.  在添加ECS实例页面，配置参数，具体参数说明如下。

    |参数|说明|
    |:-|:-|
    |备份仓库名称|备份仓库是混合云备份的云上存储仓库，用于保存备份的数据。多个客户端可以备份到同一个仓库。    -   如您之前已经创建过备份仓库

在下拉列表中选择希望使用的仓库即可。

    -   如您之前没有创建过备份仓库

单击**新建仓库**。然后输入**仓库名称**和**描述**即可创建一个新仓库。仓库名称不得超过32个字节。

 |
    |备份报警|开启后，如果备份失败或客户端与服务器连接断开，系统会向您设置的报警联系人发邮件通知。|

6.  勾选需要安装客户端的ECS实例。您也可以在搜索栏左侧，选择实例ID、实例名、VPC ID、私有IP（VPC）以及内网IP（经典网络），然后输入相应的全称或关键字搜索目标实例。如果您选择了**经典网络**类型的实例，还需输入[AccessKey Id和AccessKey Secret](../../../../../intl.zh-CN/常见问题/RAM用户如何获取AccessKey.md)。
7.  配置完成后，单击**创建**后系统会自动在您选择的ECS中安装备份客户端。

**批量安装ECS备份客户端**

如果您需要一次为多个ECS实例添加客户端，可以批量添加客户端。具体操作如下：

1.  登录[混合云备份管理控制台](https://hbr.console.aliyun.com)。
2.  选择要备份的ECS实例所在的区域。
3.  在左侧导航栏，选择**ECS备份** \> **文件备份**。
4.  在页面右上角，选择**批量操作** \> **批量添加ECS实例**。
5.  在批量添加ECS实例页面，输入**备份仓库名称**来新建一个备份仓库，然后添加仓库描述。仓库名称不得超过32个字节。
6.  （可选）指定需要安装客户端的ECS私有IP（VPC）或内网IP（经典网络）。

    **说明：** 

    -   输入指定IP后，模版中只会显示指定IP相应的ECS实例。
    -   如果不指定IP，模版中会显示当前地域下的所有ECS实例。
    -   多个IP需用英文逗号（,）分隔开。
7.  单击**下载模板**。
8.  打开下载的模板文件。填写Access Key ID及Access Key Secret（VPC网络类型的实例无需填写），然后保存文件。

    **说明：** 

    -   模版里面只会显示已安装云助手且未安装备份客户端的ECS实例。
    -   如果批量创建超过20个客户端，系统会自动创建新的仓库以容纳额外的客户端。
    -   关于如何获取Access Key ID和Access Key Secret，参见[RAM用户如何获取AccessKey](../../../../../intl.zh-CN/常见问题/RAM用户如何获取AccessKey.md)。
    -   如果您不需要在某个ECS上安装客户端，请删除该ECS所在一整行。
    -   请不要修改模板文件中的Instance Id，Instance Name，以及Network Type。
    -   为了您的账号安全，在成功上传模版之后，删除本地模版文件。
9.  单击**上传文件**，上传填写好的模板。

上传模板后，页面会显示已选择的各类型的ECS实例数量以及总数量。

## 管理实例客户端 {#section_hz5_kbv_fgb .section}

在ECS备份 / 文件备份页面，单击**ECS实例**页签，找到目标ECS实例。如实例过多，您可以在页面右上角的搜索栏，输入目标ECS实例的私有IP（VPC）或内网IP（经典网络）搜索目标ECS实例。找到目标ECS实例后，您可以：

-   查看客户端的安装状态

    安装成功后，客户端状态会显示为已激活。如状态为安装失败，请根据错误信息提示进行操作，然后在操作中选择**重新安装**。

-   卸载客户端

    您可以在实例右侧，选择**更多** \> **卸载客户端**。

-   删除客户端

    如需在ECS实例列表上删除一个ECS实例，并卸载在该ECS实例上安装的客户端，您可以在节点右侧，选择**更多** \> **删除**。

-   升级客户端

    找到目标ECS实例，单击**升级**，将当前的客户端升级到最新版本。


## 后续操作 {#section_irf_dlg_mgb .section}

[备份ECS文件](intl.zh-CN/ECS备份教程/文件备份/备份ECS文件.md)

