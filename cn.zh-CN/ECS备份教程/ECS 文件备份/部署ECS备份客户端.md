# 部署ECS备份客户端

使用ECS备份客户端备份和恢复ECS文件前，您需要在混合云备份（HBR）管理控制台部署ECS备份客户端。

## 背景信息

您可以为指定地域下的少量ECS实例安装备份客户端，也可以为某地域下指定的多个或所有ECS实例批量安装备份客户端。

当您的ECS备份客户端版本过低，您可以将其升级至最新版本；当您的ECS备份客户端激活失败或者升级失败，请卸载客户端后重新安装；当您不再需要ECS备份客户端中的备份数据时，您可以将此客户端删除。

## 少量安装ECS备份客户端

为某地域下指定的少量ECS实例安装备份客户端步骤如下：

1.  登录[混合云备份管理控制台](https://hbr.console.aliyun.com)。

2.  在左侧导航栏，选择**备份** \> **ECS文件备份**。

3.  选择要备份的ECS实例所在的区域。

4.  在ECS实例页签右上角，单击**添加ECS实例**。

5.  在添加ECS实例页面，按说明配置以下各项参数。

    |参数|说明|
    |--|--|
    |备份库配置|备份库是混合云备份的云上存储仓库，用于保存备份的数据。多个客户端可以备份到同一个备份库。备份库有地域属性，您仅能选择或者新建当前地域下的备份库。     -   如果您之前已经创建过备份库，单击**选择备份库**，并在**备份库名称**下拉框中选择已创建的备份库。
    -   如果您之前没有创建过备份库，单击**新建备份库**，然后输入**备份库名称**即可创建一个新仓库。备份库名称不得超过64个字节。 |
    |用HTTPS传输数据|数据加密存储到备份库后，您可以选择是否使用HTTPS传输数据。使用HTTPS会降低数据传输性能。如果修改了此项配置，在下一次备份或恢复任务开始时生效。|
    |ECS实例|选中需要安装客户端的ECS实例。您也可以在搜索栏左侧，选择**实例ID**、**实例名**、**VPC ID**、**私有IP（VPC）**以及**内网IP（经典网络）**，然后输入相应的全称或关键字搜索目标实例。 **说明：** 如果选择了**内网IP（经典网络）**类型的ECS实例，还需填写阿里云账号AccessKey（推荐使用RAM用户AccessKey）。 |

6.  单击**创建**，系统将自动在您选择的ECS中安装备份客户端。


## 批量安装ECS备份客户端

为某地域下指定的多个或所有ECS实例批量安装备份客户端步骤如下：

1.  登录[混合云备份管理控制台](https://hbr.console.aliyun.com)。

2.  在左侧导航栏，选择**备份** \> **ECS文件备份**。

3.  选择要备份的ECS实例所在的区域。

4.  在ECS实例页签右上角，选择**批量操作** \> **批量添加ECS实例**。

5.  在批量添加ECS实例页面，输入**备份库名称**即可创建一个备份库。仓库名称不得超过64个字节。

6.  （可选）指定需要安装客户端的ECS的私有IP（VPC）或内网IP（经典网络）。

    **说明：**

    -   如果未指定要备份的ECS的IP，模版默认列出该Region所有已安装云助手且未安装备份客户端的ECS。
    -   指定要备份的ECS的IP后，模版里面就只包括指定IP的ECS列表。
    -   多个IP需用英文逗号（,）分隔开。
7.  单击**下载模板**。

8.  打开下载的模板文件，填写**Access Key Id**及**Access Key Secret**（VPC网络类型的实例无需填写），然后保存文件。

    **说明：**

    -   如果批量创建超过20个客户端，系统会自动创建新的仓库以容纳额外的客户端。
    -   关于如何获取AccessKey，参见[查看访问密钥基本信息](/cn.zh-CN/安全设置/访问密钥/查看访问密钥基本信息.md)。
    -   如果您不需要在某个ECS上安装客户端，请删除该ECS所在一整行。
    -   请不要修改模板文件中的**Instance Id**、**Instance Name**、以及**Network Type**。
    -   为了您的账号安全，在成功上传模版之后，删除本地模版文件。
9.  单击**上传文件**，上传填写好的模板。

    上传模板后，页面会显示已选择的各类型的ECS实例数量以及总数量。


## 管理实例客户端

在ECS文件备份页面，单击**ECS实例**页签，找到目标ECS实例。如实例过多，您可以在页面右上角的搜索栏，输入目标ECS实例的私有IP（VPC）或内网IP（经典网络）搜索目标ECS实例。

找到目标ECS实例后，您可以查看客户端安装状态、卸载客户端、删除客户端以及升级客户端等。

|操作|描述|
|:-|:-|
|查看客户端的安装状态|安装成功后，客户端状态会显示为已激活。如状态为安装失败，请根据错误信息提示进行操作，然后选择**操作**列下的**更多** \> **安装客户端**。|
|卸载客户端|您可以在实例右侧，选择**操作**列下的**更多** \> **卸载客户端**。|
|删除客户端|如需在ECS实例列表上删除一个ECS实例，并卸载在该ECS实例上安装的客户端，您可以在节点右侧，选择**操作**列下的**更多** \> **删除**。 **说明：** 删除客户端会删除已有的备份数据，同时会导致正在执行的备份、恢复任务失败。删除客户端前，请您确保不再需要此客户端的备份数据，同时确保该客户端上没有正在执行的备份、恢复任务。 |
|升级客户端|找到目标ECS实例，单击**升级**，将当前的客户端升级到最新版本。|

