# 部署SQL Server

使用混合云备份服务（HBR）来备份ECS实例中部署的SQL Server数据库前，您需要在HBR控制台注册SQL Server实例。

注册SQL Server实例需要配置SQL Server连接信息，实例注册完成后混合云备份服务会在SQL Server的节点上安装ECS备份客户端。

SQL Server实例注册后，您可以查看SQL Server实例中节点的备份客户端安装状态，确保需要备份的节点已经成功安装了ECS备份客户端。然后结合业务场景升级、卸载或删除ECS备份客户端。

## 注册SQL Server实例

请按如下步骤注册SQL Server实例：

1.  登录[混合云备份管理控制台](https://hbr.console.aliyun.com)。

2.  在左侧导航栏，选择**备份** \> **ECS应用备份** \> **SQL Server**。

3.  在页面上方，选择要备份的ECS实例所在的区域。

4.  在页面右上角，单击**注册SQL Server实例**。

5.  在注册SQL Server实例页面，按照以下说明配置所需信息。

    |参数|说明|
    |:-|:-|
    |备份库配置|备份库是混合云备份的云上存储仓库，用于保存备份的数据。多个客户端可以备份到同一个备份库。备份库有地域属性，您仅能选择或者新建当前地域下的备份库。     -   如果您之前已经创建过备份库，单击**选择备份库**，并在**备份库名称**下拉框中选择已创建的备份库。
    -   如果您之前没有创建过备份库，单击**新建备份库**，然后输入**备份库名称**即可创建一个新仓库。备份库名称不得超过64个字节。 |
    |服务器名称|SQL Server服务器名称及实例名称，格式为：<服务器名\>\\<实例名\>。例如：localhost\\MSSQLSERVER。默认实例可不填写实例名称。 **说明：** 您可以使用服务器的IP地址替代服务器名称。 |
    |认证方式|选择SQL Server的认证方式。|
    |Windows用户名|如果您选择了Windows用户认证方式，则需要输入连接SQL Server的Windows用户名。|
    |SQL Server用户名|如果您选择了SQL Server认证方式，则需要输入连接SQL Server的SQL Server用户名。|
    |密码|根据您选择的认证方式，输入连接SQL Server的密码。|

6.  单击**下一步**。

7.  在安装备份客户端页面，选择是否**用HTTPS传输数据**，并选中需要部署SQL Server的ECS实例，混合云备份服务将为该实例安装ECS备份客户端。您可以在搜索栏左侧，选择实例ID、实例名，然后输入相应的全称或关键字搜索目标ECS实例。

    **说明：**

    -   数据加密存储到备份库后，您可以选择是否使用HTTPS传输数据。使用HTTPS会降低数据传输性能。如果修改了此项配置，在下一次备份或恢复任务开始时生效。
    -   如果您选择了经典网络类型的实例，还需输入AccessKey Id和AccessKey Secret，详情请参见[为RAM用户创建AccessKey](/cn.zh-CN/常见问题/一般性问题/为RAM用户创建AccessKey.md)。
8.  单击**创建**。系统会自动在您选择的ECS实例中安装备份客户端。

    SQL Server实例注册完成后，在SQL Server备份页面，选择**SQL Server实例**页签，可以查看实例的注册信息及状态。在实例右侧的操作列表，单击**更多** \> **编辑实例**，修改实例的连接信息。


## 查看并管理客户端

SQL Server实例注册后，您可以查看SQL Server实例中节点的备份客户端安装状态、升级或删除备份客户端、查看目标SQL Server实例的数据库相关信息等。

-   查看节点客户端安装状态

    查看需要备份的节点是否已经成功安装了ECS备份客户端。具体操作步骤如下：

    1.  SQL Server实例注册完成后，单击**SQL Server实例**页签。
    2.  找到目标SQL Server实例，单击实例ID，或单击实例右侧**更多** \> **查看详情**。
    3.  在SQL Server实例信息页面，单击**客户端**页签，查看节点的备份客户端安装状态。如成功安装，状态为已激活，您还可以进行以下操作：

        |操作|步骤|
        |:-|:-|
        |重新安装客户端|如安装失败可以在节点右侧的操作栏，单击**更多** \> **安装**。|
        |卸载客户端|如需在节点上卸载客户端，您可以在节点右侧的操作栏，单击**更多** \> **卸载客户端**。|
        |删除客户端|如需删除备份节点，并卸载在该备份节点上安装的客户端，您可以在节点右侧的操作栏，单击**更多** \> **删除**。 **说明：** 删除客户端会删除已有的备份数据，同时会导致正在执行的备份、恢复任务失败。删除客户端前，请您确保不再需要此客户端的备份数据，同时确保该客户端上没有正在执行的备份、恢复任务。 |

-   查看数据库

    您可以查看SQL Server实例的数据库信息，具体步骤如下：

    1.  找到目标SQL Server实例，单击实例ID，或单击实例右侧**更多** \> **查看详情**。
    2.  单击**数据库**页签，可以查看目标SQL Server实例的数据库相关信息。

